[{"title":"DSP知识整理","url":"/dsp知识整理/","content":"# 一、DSP概述\n### 硬件：\n- 高速控制和信号处理\n- 采用流水线操作\n- 采用哈佛结构，数据存储区和程序存储区分离，数据总线和程序总线也是分开的\n- 大多配有硬件乘法器和加法器，同一时钟周期内可以完成累加和累乘\n- 零开销循环\n\n### 软件：\n- 显示MAC（乘加器）指令\n- 精简指令集\n- 专门的寻址方式\n\n### DSP分类\n按数据格式分：\n- 定点\n- 浮点\n\n按用途分：\n- 通用\n- 专用\n\n# 二、TMS320F2812\n\n### CPU\n- 32位定点CPU\n- 150MHz\n- 当频率为135MHz时，核心电压1.8V；当频率为150MHz时，核心电压为1.9V；输出IO口电压为3.3V\n### 内存\n- 18kW RAM\n- 128kW Flash\n\n### 外设功能模块\n- 控制类\n  - IO\n  - 定时器\n  - PWM\n\n- 测量类\n  - 数字：捕获、正交编码\n  - 模拟：ADC\n\n- 通讯类\n  - UART\n  - eCAN\n  - SPI\n  - McBsp\n\n### 其他\n外设中断扩展模块（PIE）\n- 支持45个外部中断\n\n片上存储器\n- 128kW Flash\n- 1kW的OTP型存储器\n- 18kW的SARAM\n  - L0和L1：两个4kW的SARAM\n  - H0: 8kW\n  - M0和M1：两个1kW的SARAM\n- 56个可编程IO口\n- 时钟和系统控制\n- 3个32位CPU定时器\n- 马达控制外设\n  - 两个事件管理器\n- 12位ADC，16通道\n\n### 寻址方式 \n1. 直接寻址\n2. 间接寻址\n3. 寄存器寻址\n4. 堆栈寻址\n5. 数据/地址/IO空间立即寻址方式\n6. 程序空间间接寻址方式\n\n### C28x流水线\n- 八级流水线，五个阶段\n- 取指令，译码，读取数据，执行，写回\n\n# 三、时钟和系统控制\n![OSC&PLL](../img/DSP/OSC&PLL.png)\n时钟CLKIN的来源有两种，一种是外部晶振提供，另一种是外部时钟输入。可以通过引脚<span style=\"text-decoration: overline\">XF_PLLDIS</span>来控制选择。\n- 晶振：20MHz ~ 35MHz\n- 外部时钟：有PLL: 5 ~ 100MHz；无PLL: 4 ~ 150MHz\n\n在使用对应的外设之前，需要使能它们的时钟。与外设时钟使能相关的寄存器是<u>外设时钟使能寄存器PCLKCR</u>。\n\nSYSCLK经过分频可以得到低速外设时钟LSPCLK和高速外设时钟HSPCLK，它们互相独立，分别给高速外设和低速外设供应时钟信号。\n\n### 看门狗电路\n当八位的<u>看门狗加法计数器WDCNTR</u>达到最大值时，看门狗模块输出一个512个周期的脉冲，使系统复位。\n\n如果不想使用看门狗，可以直接禁止看门狗。\n\n如果启用了看门狗，当程序正常运行时，我们需要定期向WDCNTR依次顺序写入0x55和0xAA来清零，实现“喂狗”操作。\n\n逻辑校验位是看门狗的另一个安全机制，访问<u>看门狗控制器WDCR</u>的写操作中，相应的校验位必须为“101”，否则会立即拒绝访问并引发系统复位。\n\n### 低功耗模式\n- 空闲模式：CPU进入低功耗模式，部分外设不使用时时钟选择性关闭，会自动降低频率来降低功耗，任何使能的外设中断都可以唤醒此模式。\n- 暂停模式：片上所有设备停止工作\n- 备用模式：关闭CPU和外设时钟，OSC和PLL正常工作\n\n# 四、CPU定时器\nx2812内部有3个32位的CPU定时器，其中只有Timer0可供用户使用，Timer1和Timer2都被系统保留。\n\n\n"}]